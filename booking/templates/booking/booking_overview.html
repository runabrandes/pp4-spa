{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="d-flex justify-content-center col-md-12">
    <div class="container mt-5 text-center">
        <div class="row d-flex justify-content-center">
            <h2 class="mt-3">Upcoming Bookings</h2>

            {% for booking in bookings %}

            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th scope="col">Date</th>
                        <th scope="col">Time</th>
                        <th scope="col">Service</th>
                        <th scope="col">Confirmed</th>
                        <th scope="col">Edit</th>
                        <th scope="col">Delete</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ booking.booking_date|date:"j F Y"}}</td>

                        <td>{{ booking.booking_time|time:"G:i" }}</td>
                        <td>{{booking.service}}</td>
                        <td>
                            {% if booking.booking_confirmed %}
                            <i class="fa-regular fa-circle-check text-success"></i>
                            {% else %}
                            <i class="fa-regular fa-circle-xmark text-danger"></i>
                            {% endif %}
                        </td>
                        <td><button type="button" class="table-btn btn-edit" data-bs-toggle="modal"
                                data-bs-target="#confirmEdit{{booking.id}}" aria-label="Edit confirm button"><i
                                    class="fa-regular fa-pen-to-square"></i></button></td>
                        <td><button type="button" class="table-btn btn btn-danger btn-delete" data-bs-toggle="modal"
                                data-bs-target="#confirmCancellation{{booking.id}}"
                                aria-label="Cancellation confirm button"><i
                                    class="fa-solid fa-trash-can text-dark"></i></button></td>
                    </tr>
                </tbody>
            </table>
            {% endfor %}

        </div>

        <!-- Cancellation confirmation modal -->

        {% for booking in bookings %}

        <div class="modal fade" id="confirmCancellation{{booking.id}}" tabindex="-1"
            aria-labelledby="confirmCancellationLabel{{booking.id}}" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="confirmCancellationLabel{{booking.id}}">Cancel Booking?</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            Are you sure you want to cancel your booking?
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-dark" data-bs-dismiss="modal"
                            aria-label="Abort cancellation button">
                            No
                        </button>

                        <a href="{% url 'cancel_booking' booking.id %}" class="btn btn-danger btn-delete"
                            aria-label="Cancellation confirmation button">Yes</a>
                    </div>
                </div>
            </div>
        </div>

        {% endfor %}

        <!-- Edit confirmation modal -->

        {% for booking in bookings %}

        <div class="modal fade" id="confirmEdit{{booking.id}}" tabindex="-1"
            aria-labelledby="confirmEditLabel{{booking.id}}" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="confirmEditLabel{{booking.id}}">Edit Booking?</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            Are you sure you want to update your booking?
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-dark" data-bs-dismiss="modal"
                            aria-label="Abort edit button">
                            No
                        </button>

                        <a href="{% url 'edit_booking' booking.id %}" class="btn btn-danger btn-delete"
                            aria-label="Edit confirmation button">Yes</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endfor %}

{% endblock content %}